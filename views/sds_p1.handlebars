<h3 class="s-title">Fine dust (10 µm)</h3>
<div id="chart_sds_p1" style="width: 900px; height: 500px"></div>
<div style="text-align: center">
  <label for="entries">Show</label>
  <input type="number" min="2" max="10000" id="entries" value="300" disabled />
  <label for="entries">entries</label>
</div>

<script type="text/javascript" async defer>
  const options = buildOptions('Fine dust (10 µm) in the last 12 hours', '##,## µg/m^3');

  google.charts.load('current', {packages: ['line', 'corechart'], language: 'en-GB'})
    .then(() => getData('sds_p1'))
    .then(jsonData => {
      const sdsP1Data = jsonData.map(entry => {
        const {created_at, SDS_P1} = entry;
        return [new Date(created_at), SDS_P1];
      });

      function updateTable(limit) {
        const dataTable = buildDataTable('Fine dust (10 µm)', sdsP1Data.slice(0, limit));
        buildChart('chart_sds_p1').draw(dataTable, options);
      }

      document.getElementById('entries').addEventListener('input', event => {
        try {
          const limit = parseInt(event.target.value, 10);
          updateTable(limit)
        } catch (error) {
          console.error(error);
        }
      }, {passive: true});

      updateTable(300);
      document.getElementById('entries').disabled = false;
    });
</script>
